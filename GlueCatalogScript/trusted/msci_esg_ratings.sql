CREATE EXTERNAL TABLE `msci_esg_ratings`(
  `issuer_name` string,
  `issuerid` string,
  `issuer_cusip` string,
  `issuer_isin` string,
  `issuer_cntry_domicile` string,
  `as_of_date` string,
  `iva_industry` string,
  `iva_rating_date` date,
  `iva_company_rating` string,
  `iva_previous_rating` string,
  `iva_rating_trend` int,
  `industry_adjusted_score` double,
  `weighted_average_score` double,
  `esg_overall_quartile` int,
  `environmental_pillar_score` double,
  `environmental_pillar_weight` double,
  `environmental_pillar_quartile` int,
  `social_pillar_score` double,
  `social_pillar_weight` double,
  `social_pillar_quartile` int,
  `governance_pillar_score` double,
  `governance_pillar_weight` double,
  `governance_pillar_quartile` int,
  `biodiv_land_use_score` double,
  `biodiv_land_use_weight` double,
  `biodiv_land_use_exp_score` double,
  `biodiv_land_use_mgmt_score` double,
  `biodiv_land_use_quartile` int,
  `carbon_emissions_score` double,
  `carbon_emissions_weight` double,
  `carbon_emissions_exp_score` double,
  `carbon_emissions_mgmt_score` double,
  `carbon_emissions_quartile` int,
  `opps_cln_tech_score` double,
  `opps_cln_tech_weight` double,
  `opps_cln_tech_exp_score` double,
  `opps_cln_tech_mgmt_score` double,
  `opps_cln_tech_quartile` int,
  `financing_env_imp_score` double,
  `financing_env_imp_weight` double,
  `financing_env_imp_exp_score` double,
  `financing_env_imp_mgmt_score` double,
  `financing_env_imp_quartile` int,
  `e_waste_score` double,
  `e_waste_weight` double,
  `e_waste_exp_score` double,
  `e_waste_mgmt_score` double,
  `e_waste_quartile` int,
  `opps_green_building_score` double,
  `opps_green_building_weight` double,
  `opps_green_building_exp_score` double,
  `opps_green_building_mgmt_score` double,
  `opps_green_building_quartile` int,
  `pack_mat_waste_score` double,
  `pack_mat_waste_weight` double,
  `pack_mat_waste_exp_score` double,
  `pack_mat_waste_mgmt_score` double,
  `pack_mat_waste_quartile` int,
  `raw_mat_src_score` double,
  `raw_mat_src_weight` double,
  `raw_mat_src_quartile` int,
  `opps_renew_energy_score` double,
  `opps_renew_energy_weight` double,
  `opps_renew_energy_exp_score` double,
  `opps_renew_energy_mgmt_score` double,
  `opps_renew_energy_quartile` int,
  `toxic_emiss_wste_score` double,
  `toxic_emiss_wste_weight` double,
  `toxic_emiss_wste_exp_score` double,
  `toxic_emiss_wste_mgmt_score` double,
  `toxic_emiss_waste_quartile` int,
  `ins_climate_chg_risk_score` double,
  `ins_climate_chg_risk_weight` double,
  `ins_climate_chg_risk_exp_score` double,
  `ins_climate_chg_risk_mgmt_score` double,
  `ins_climate_chg_risk_quartile` int,
  `prod_carb_ftprnt_score` double,
  `prod_carb_ftprnt_weight` double,
  `prod_carb_ftprnt_exp_score` double,
  `prod_carb_ftprnt_mgmt_score` double,
  `prod_carb_ftprnt_quartile` int,
  `water_stress_score` double,
  `water_stress_weight` double,
  `water_stress_exp_score` double,
  `water_stress_mgmt_score` double,
  `water_stress_quartile` int,
  `access_to_comm_score` double,
  `access_to_comm_weight` double,
  `access_to_comm_exp_score` double,
  `access_to_comm_mgmt_score` double,
  `access_to_comm_quartile` int,
  `access_to_fin_score` double,
  `access_to_fin_weight` double,
  `access_to_fin_exp_score` double,
  `access_to_fin_mgmt_score` double,
  `access_to_fin_quartile` int,
  `access_to_hlthcre_score` double,
  `access_to_hlthcre_weight` double,
  `access_to_hlthcre_exp_score` double,
  `access_to_hlthcre_mgmt_score` double,
  `access_to_hlthcre_quartile` int,
  `chem_safety_score` double,
  `chem_safety_weight` double,
  `chem_safety_exp_score` double,
  `chem_safety_mgmt_score` double,
  `chem_safety_quartile` int,
  `opps_nutri_hlth_score` double,
  `opps_nutri_hlth_weight` double,
  `opps_nutri_hlth_exp_score` double,
  `opps_nutri_hlth_mgmt_score` double,
  `opps_nutri_hlth_quartile` int,
  `hlth_safety_score` double,
  `hlth_safety_weight` double,
  `hlth_safety_exp_score` double,
  `hlth_safety_mgmt_score` double,
  `hlth_safety_quartile` int,
  `human_capital_dev_score` double,
  `human_capital_dev_weight` double,
  `human_capital_dev_exp_score` double,
  `human_capital_dev_mgmt_score` double,
  `human_capital_dev_quartile` int,
  `labor_mgmt_score` double,
  `labor_mgmt_weight` double,
  `labor_mgmt_exp_score` double,
  `labor_mgmt_mgmt_score` double,
  `labor_mgmt_quartile` int,
  `privacy_data_sec_score` double,
  `privacy_data_sec_weight` double,
  `privacy_data_sec_exp_score` double,
  `privacy_data_sec_mgmt_score` double,
  `privacy_data_sec_quartile` int,
  `prod_sfty_quality_score` double,
  `prod_sfty_quality_weight` double,
  `prod_sfty_quality_exp_score` double,
  `prod_sfty_quality_mgmt_score` double,
  `prod_sfty_quality_quartile` int,
  `controv_src_score` double,
  `controv_src_weight` double,
  `controv_src_exp_score` double,
  `controv_src_mgmt_score` double,
  `controv_src_quartile` int,
  `responsible_invest_score` double,
  `responsible_invest_weight` double,
  `responsible_invest_exp_score` double,
  `responsible_invest_mgmt_score` double,
  `responsible_invest_quartile` int,
  `fin_prod_safety_score` double,
  `fin_prod_safety_weight` double,
  `fin_prod_safety_exp_score` double,
  `fin_prod_safety_mgmt_score` double,
  `fin_prod_safety_quartile` int,
  `supply_chain_lab_score` double,
  `supply_chain_lab_weight` double,
  `supply_chain_lab_exp_score` double,
  `supply_chain_lab_mgmt_score` double,
  `supply_chain_lab_quartile` int,
  `ins_hlth_demo_risk_score` double,
  `ins_hlth_demo_risk_weight` double,
  `ins_hlth_demo_risk_exp_score` double,
  `ins_hlth_demo_risk_mgmt_score` double,
  `ins_hlth_demo_risk_quartile` int,
  `anticomp_pract_score` double,
  `anticomp_pract_weight` double,
  `anticomp_pract_mgmt_score` double,
  `bus_ethics_fraud_score` double,
  `bus_ethics_fraud_weight` double,
  `bus_ethics_fraud_mgmt_score` double,
  `corruption_inst_score` double,
  `corruption_inst_weight` double,
  `corruption_inst_exp_score` double,
  `corruption_inst_mgmt_score` double,
  `corruption_inst_quartile` int,
  `financial_sys_inst_score` double,
  `financial_sys_inst_weight` double,
  `financial_sys_inst_exp_score` double,
  `financial_sys_inst_mgmt_score` double,
  `financial_sys_inst_quartile` int,
  `tax_transp_score` double,
  `tax_transp_weight` double,
  `corp_governance_score` double,
  `corp_governance_weight` double,
  `corp_governance_quartile` int,
  `gm_home_market` string,
  `assessment_change_date` date,
  `governance_pctl_global` int,
  `governance_pctl_home` int,
  `board_pctl_global` int,
  `board_pctl_home` int,
  `pay_pctl_global` int,
  `pay_pctl_home` int,
  `ownership_pctl_global` int,
  `ownership_pctl_home` int,
  `accounting_pctl_global` int,
  `accounting_pctl_home` int,
  `cppib_sec_id` bigint,
  `df_meta_epoch` string,
  `df_meta_file_name` string,
  `df_meta_system_process_date` timestamp,
  `df_meta_run_date` string,
  `df_meta_job_id` string)
PARTITIONED BY (
  `data_date` string)
ROW FORMAT SERDE
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  's3://cppib-data-fabric-trusted-${env}/msci/msci_esg_ratings'