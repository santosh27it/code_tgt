CREATE EXTERNAL TABLE `iss_director_data`(
  `snapshotdetailid` int,
  `companyid` int,
  `companyname` string,
  `isin` string,
  `ticker` string,
  `gics` int,
  `exchangename` string,
  `country` string,
  `meetingid` int,
  `meetingdate` date,
  `asofdate` date,
  `meetingtype` string,
  `meetingsubtype` string,
  `classifiedboardyn` string,
  `cumulativevotingyn` string,
  `hasretirementplanyn` string,
  `dirretirementage` int,
  `hastenurepolicyyn` string,
  `tenurepolicyinyrs` int,
  `ceoischairyn` string,
  `boardsize` int,
  `avgboardtenureyrs` double,
  `avgdirectorage` double,
  `numemployeedirectors_iss` int,
  `numaffiliateddirs_iss` int,
  `numindependentdirs_iss` int,
  `chairclassification_iss` string,
  `chairclassification_co` string,
  `numcontinuingnominees` int,
  `numshareholdernominees` int,
  `numnewmgmtnominees` int,
  `numwomenonboard` int,
  `pctwomenonboard` double,
  `sumofoutsideboards` int,
  `pctexec_iss` double,
  `pctexec_co` double,
  `pctinsider_iss` double,
  `pctinsider_co` double,
  `pctni_ned_iss` double,
  `pctni_ned_co` double,
  `pctao_iss` double,
  `pctao_co` double,
  `pctindependent_iss` double,
  `pctindependent_co` double,
  `pcti_ned_iss` double,
  `pcti_ned_co` double,
  `pctemprep_iss` double,
  `pctemprep_co` double,
  `seperatechairyn` string,
  `numsharesheldbyboard` int,
  `pctctrlvotingpower` double,
  `numfinancialexperts` int,
  `numrelativeemps` int,
  `numformeremps` int,
  `numinterlockdirs` int,
  `numcharitableaffdirs` int,
  `numgovaffdirs` int,
  `numshrepdirs` int,
  `numsigshdirs` int,
  `numfounders` int,
  `numempreps` int,
  `numempshreps` int,
  `numdirswithtenuredisc` int,
  `numdirswprofservdisc` int,
  `numboardattestation` int,
  `actnumofboardmeetings` int,
  `numformerceos` int,
  `numdirswithlt75pctatt` int,
  `dopctctrlvotingpower` double,
  `numnonmgmtboardmeeting` int,
  `numpartytrans` int,
  `totdollarvalueoftransaction` double,
  `bc_hasnomcomm` string,
  `bc_hascompcomm` string,
  `bc_hasauditcomm` string,
  `bc_hasgovcomm` string,
  `bc_nomcommsize` int,
  `bc_compcommsize` int,
  `bc_auditcommsize` int,
  `bc_nomindepdircnt` int,
  `bc_compindepdircnt` int,
  `bc_auditindepdircnt` int,
  `bc_numnommeetings` int,
  `bc_numcompmeetings` int,
  `bc_numauditmeetings` int,
  `directorid` int,
  `bio_firstname` string,
  `bio_lastname` string,
  `bio_womanyn` string,
  `bio_age` int,
  `bio_birthyear` int,
  `bio_disclosedbio` string,
  `bio_biourl` string,
  `bio_assessedethnicity` string,
  `bio_primempname` string,
  `boards_chairmanyn` string,
  `boards_leaddirectoryn` string,
  `boards_directortitle` string,
  `boards_dirsince` int,
  `boards_nomineetypeid` int,
  `boards_nomineetype` string,
  `duedil_att75pctyn` string,
  `committee_auditrole` string,
  `committee_comprole` string,
  `committee_nomrole` string,
  `committee_govrole` string,
  `aff_dirclass_iss` string,
  `aff_dirclass_co` string,
  `aff_isceoyn` string,
  `aff_finexpertyn` string,
  `aff_relativeempyn` string,
  `aff_formerempyn` string,
  `aff_chrtbleafflnyn` string,
  `aff_govrepyn` string,
  `aff_shareholderrepyn` string,
  `aff_sigshareholderyn` string,
  `aff_founderyn` string,
  `aff_emprepyn` string,
  `aff_empshareholderrepyn` string,
  `aff_tenureyn` string,
  `aff_profserviceyn` string,
  `aff_boardattestafflnyn` string,
  `aff_formerceoyn` string,
  `aff_ceoanothercompanyyn` string,
  `aff_numpartytrans` int,
  `aff_dollarvaloftrans` double,
  `sn_numoutsideboards` int,
  `sn_interlockyn` string,
  `owncomp_numofshares` int,
  `owncomp_pctctrlvotingpower` double,
  `academia` string,
  `skill_audit_accountingyn` string,
  `skill_ceo_md_chairmanyn` string,
  `skill_cfoyn` string,
  `skill_csr_sriyn` string,
  `skill_financialyn` string,
  `skill_gov_militaryyn` string,
  `skill_humanresources_yn` string,
  `skill_industry_relevant_experienceyn` string,
  `skill_international_experienceyn` string,
  `skill_leadershipyn` string,
  `skill_mergers_and_acquisitionsyn` string,
  `skill_operationsyn` string,
  `skill_riskyn` string,
  `skill_sales_marketing_publicrelationsyn` string,
  `skill_strategicplanningyn` string,
  `skill_tech_engineeringyn` string,
  `haselectionyn` string,
  `levelofsupport` double,
  `issvoterec` string,
  `voteresult` string,
  `voteresultcollecteddate` date,
  `issvoterecdate` date,
  `df_meta_epoch` string,
  `df_meta_file_name` string,
  `df_meta_system_process_date` timestamp,
  `df_meta_run_date` string,
  `df_meta_job_id` string,
  `cppib_sec_id` bigint)
PARTITIONED BY (
  `file_date` string)
ROW FORMAT SERDE
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  's3://cppib-data-fabric-trusted-${env}/iss/iss_director_data'