CREATE EXTERNAL TABLE `msci_carbon_metrics`(
  `issuer_name` string,
  `issuerid` string,
  `issuer_cusip` string,
  `issuer_sedol` string,
  `issuer_isin` string,
  `issuer_cntry_domicile` string,
  `as_of_date` date,
  `issuer_cntry_domicile_name` string,
  `fossil_fuel_reserves` string,
  `intensity_of_ff_reserves` double,
  `low_carbon_reduction` string,
  `fossil_fuel_reserves_sources` string,
  `total_potential_emissions` double,
  `total_energy_content` double,
  `total_potential_emissions_ex_met_coal` double,
  `industry_energy_application` string,
  `industry_energy_producer` string,
  `industry_energy_supplier` string,
  `industry_industrial_application` string,
  `industry_other_application` string,
  `metallurgical_coal_reserves` string,
  `thermal_coal_reserves` string,
  `coal_reserves` string,
  `met_coal_potential_emissions` double,
  `met_coal_reserves_key` string,
  `met_coal_reserves_volume` double,
  `thermal_coal_max_rev_pct` double,
  `th_coal_potential_emissions` double,
  `th_coal_reserves_key` string,
  `th_coal_reserves_volume` double,
  `coal_potential_emissions` double,
  `coal_reserves_volume` double,
  `conv_oil_reserves_key` double,
  `conv_oil_potential_emissions` double,
  `conv_oil_reserves_volume` double,
  `conv_oil_reserves` string,
  `natural_gas_reserves` string,
  `oil_sands_reserves` string,
  `shale_gas_reserves` string,
  `shale_oil_gas_reserves` string,
  `shale_oil_reserves` string,
  `nat_gas_reserves` string,
  `oil_nat_gas_reserves` string,
  `oil_reserves` string,
  `natural_gas_potential_emissions` double,
  `natural_gas_reserves_key` string,
  `natural_gas_reserves_volume` double,
  `oil_sands_max_rev_pct` double,
  `oil_sands_potential_emissions` double,
  `oil_sands_reserves_key` string,
  `oil_sands_reserves_volume` double,
  `shale_gas_potential_emissions` double,
  `shale_gas_reserves_key` string,
  `shale_gas_reserves_volume` double,
  `shale_oil_reserves_key` string,
  `shale_oil_gas_potential_emissions` double,
  `shale_oil_gas_reserves_volume` double,
  `shale_oil_potential_emissions` double,
  `shale_oil_reserves_volume` double,
  `nat_gas_potential_emissions` double,
  `nat_gas_reserves_key` string,
  `nat_gas_reserves_volume` double,
  `oil_nat_gas_potential_emissions` double,
  `oil_nat_gas_reserves_volume` double,
  `oil_potential_emissions` double,
  `oil_reserves_key` string,
  `oil_reserves_volume` double,
  `unconv_oil_gas_potential_emissions` double,
  `unconv_oil_gas_reserves_volume` double,
  `carbon_emissions_year` int,
  `carbon_emissions_scope_1` double,
  `carbon_emissions_scope_1_key` string,
  `carbon_emissions_scope_12` string,
  `carbon_emissions_scope_12_inten_3yavg` double,
  `carbon_emissions_scope_12_industry_intensity` double,
  `carbon_emissions_scope_12_inten` double,
  `carbon_emissions_intensity_year` int,
  `carbon_emissions_scope_12_key` string,
  `carbon_emissions_scope_2` double,
  `carbon_emissions_scope_2_key` string,
  `carbon_emissions_scope_3` double,
  `carbon_emissions_scope_3_downstream_intensity_sales_recent` double,
  `carbon_emissions_scope_3_upstream_intensity_sales_recent` double,
  `carbon_emissions_scope_3_downstream_report` double,
  `carbon_emissions_scope_3_down_sub_ind_emissions` double,
  `carbon_emissions_scope_3_down_sub_ind_emissions_intensity_key` string,
  `carbon_emissions_scope_3_down_sub_ind_emissions_category` string,
  `carbon_emissions_scope_3_down_sub_ind_intensity` double,
  `carbon_emissions_scope_3_down_sub_ind_intensity_unit` string,
  `carbon_emissions_scope_3_downstream_year` int,
  `carbon_emissions_scope_3_undefined_report` double,
  `carbon_emissions_scope_3_upstream_report` double,
  `carbon_emissions_scope_3_upstream_intensity_report` double,
  `carbon_emissions_scope_3_upstream_tier1` double,
  `carbon_emissions_scope_3_upstream_tier1_intensity` double,
  `carbon_emissions_scope_3_upstream` double,
  `carbon_emissions_scope_3_upstream_intensity` double,
  `carbon_emissions_scope_3_upstream_year` int,
  `carbon_sales_intensity_recent` double,
  `thermal_coal_involvement_anypct` string,
  `oil_sands_involvement_anypct` string,
  `rev_biofuels` double,
  `og_rev_distribution` double,
  `og_rev_equipmt_services` double,
  `og_rev_extraction_prod` double,
  `og_rev_petrochemicals` double,
  `og_rev_pipelines_transp` double,
  `og_rev_refining` double,
  `og_rev_trading` double,
  `og_rev` double,
  `doi_oil_gas_rev` double,
  `unconv_oil_gas_max_rev_pct` double,
  `conv_oil_gas_max_rev_pct` double,
  `thermal_coal_any_tie` string,
  `oil_gas_any_tie` string,
  `oil_sands_any_tie` string,
  `shale_gas_shale_oil_any_tie` string,
  `fossil_fuels_any_tie` string,
  `ff_reserves_energy_application` string,
  `shale_oil_rev_key` string,
  `shale_oil_max_rev_pct` double,
  `shale_gas_rev_key` string,
  `shale_gas_max_rev_pct` double,
  `oil_sands_rev_key` string,
  `shale_oil_production` string,
  `shale_gas_production` string,
  `oil_sands_production` string,
  `arctic_oil_production` string,
  `arctic_gas_production` string,
  `arctic_oil_rev_key` string,
  `arctic_oil_max_rev_pct` double,
  `arctic_gas_rev_key` string,
  `arctic_gas_max_rev_pct` double,
  `marketcap_usd` double,
  `sales_usd_recent` double,
  `df_meta_epoch` string,
  `df_meta_file_name` string,
  `df_meta_system_process_date` timestamp,
  `df_meta_job_id` string,
  `df_meta_run_date` string)
PARTITIONED BY (
  `file_date` string)
ROW FORMAT SERDE
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  's3://cppib-data-fabric-trusted-${env}/msci/msci_carbon_metrics'